<!--
Shanoir NG - Import, manage and share neuroimaging data
Copyright (C) 2009-2019 Inria - https://www.inria.fr/
Contact us on https://project.inria.fr/shanoir/

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

You should have received a copy of the GNU General Public License
along with this program. If not, see https://www.gnu.org/licenses/gpl-3.0.html
-->

<span class="subtitle">These are the compatible quality cards that you can apply all over your study.</span>

<ng-container *ngFor="let qualityCard of qualityCards">
    <div>
        <span class="sc-name left-icon" 
                [routerLink]="'/quality-card/details/' + qualityCard?.id" 
                routerLinkActive="active"
                title="open details">
            <i class="fa-solid fa-shuffle"></i>{{qualityCard.name}}
        </span>
        <span class="nb-rules" (mouseover)="onMouseOverNbRules(qualityCard, $event)" (mouseleave)="onMouseOutNbRules(qualityCard)" [class.hover]="selectedQualityCard?.id == qualityCard.id">
            {{qualityCard.rules?.length}} rule(s)
            <study-card-rules class="rules" cardType="qualitycard"
                    *ngIf="selectedQualityCard?.id == qualityCard.id"
                    [ngModel]="selectedQualityCard.rules" 
                    mode="view"
                    [allCoils]="allCoils">
            </study-card-rules>
        </span>
        <button type="button" *ngIf="!pagings.get(qualityCard.id)" class="alt right-icon apply" (click)="apply(qualityCard)" [disabled]="loading.get(qualityCard.id)">
            Apply
            <i *ngIf="loading.get(qualityCard.id)" class="fa fa-cog fa-spin"></i> 
        </button>
        <ng-container *ngIf="pagings.get(qualityCard.id)">
            <button type="button" class="alt apply" disabled>Applied !</button>
            <button type="button" class="apply right-icon" (click)="downloadReport(qualityCard)">
                Download report
                <i class="fas fa-floppy-disk"></i>
            </button>
            <span class="right-icon">See report<i class="fa-solid fa-arrow-down"></i></span> 
        </ng-container>
    </div>
    <shanoir-table
            *ngIf="pagings.get(qualityCard.id)"
            [getPage]="getPage.get(qualityCard.id).bind(this)"
            [columnDefs]="columnDefs"
            [browserSearch]="false"
            [collapseControls]="true"
    ></shanoir-table>
</ng-container>
