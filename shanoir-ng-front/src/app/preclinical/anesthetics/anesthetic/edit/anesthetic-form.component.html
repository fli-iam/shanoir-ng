<div class="AnestheticFormComponent content-component">
    <form *ngIf="form"  [formGroup]="form" class="max-content" novalidate>
		<table class="layout">
			<tr><td colspan="2">
				<span class="right-col" [ngSwitch]="mode">
					<ng-template [ngSwitchCase]="'view'"> 
						<div class="header command-zone" i18n="View anesthetic|Title">View anesthetic</div>
					</ng-template>
					<ng-template [ngSwitchCase]="'edit'"> 
						<div class="header command-zone" i18n="Edit anesthetic|Title">Edit anesthetic</div>
					</ng-template>
					<ng-template [ngSwitchCase]="'create'"> 
						<div class="header command-zone" i18n="Create anesthetic|Title">Add anesthetic</div>
					</ng-template>
				</span>
			</td></tr>
			<tr>
				<td>
					<fieldset>
					<ol>
						<label *ngIf="isAnestheticUnique==false" class="form-validation-alert" i18n="Edit anesthetic|AnestheticUniqueError label">This anesthetic already exists!</label>
						<li class="required">
							<label i18n="Edit anesthetic|Name label" class="required-label">Name</label> 
							<!-- <input type="text" id="name" formControlName="name" [(ngModel)]="anesthetic.name"/> -->
							<label class="label_light" *ngIf="anesthetic.name == undefined || anesthetic.name == ''">Name is automatically generated</label>
							<label id="name" *ngIf="anesthetic.name">{{anesthetic.name}}</label> 
						</li>
						<li class="required">
							<label i18n="Edit anesthetic|AnestheticType label" class="required-label">Type</label> 
							<span class="right-col" [ngSwitch]="mode">
								<ng-template [ngSwitchCase]="'view'"> 
										{{enumUtils.getEnumValue(anestheticTypes,anesthetic.anestheticType)}}
								</ng-template>
								<ng-template ngSwitchDefault>
									<select id="anestheticType" required formControlName="anestheticType" [(ngModel)]="anesthetic.anestheticType" (change)="onChangeType()">
										<option *ngFor="let anestheticType of anestheticTypes" [value]="anestheticType.key">{{anestheticType.value}}</option>
									</select>
									<label *ngIf="hasError('anestheticType', ['required'])" [@slideDown]="hasError('anestheticType', ['required'])" class="form-validation-alert" i18n="Edit anestheticType|Type required error@@anestheticDetailTypeRequiredError">Type is required!</label>
								</ng-template>
							</span>
						</li>
						<li class="required">
							<label i18n="Edit anesthetic|Comment label">Comment</label>
							<span class="right-col" [ngSwitch]="mode">
								<ng-template [ngSwitchCase]="'view'"> 
										{{anesthetic?.comment}}
								</ng-template>
								<ng-template ngSwitchDefault>							
									<textarea rows="4"  id="comment" formControlName="comment" [(ngModel)]="anesthetic.comment"></textarea>
								</ng-template>							
							</span>
						</li>
						<li>
							<legend i18n="AnestheticDetail|Ingredients label@@anestheticDetailIngredients">Ingredients</legend>
							
							<div [ngSwitch]="mode">
								<ng-template [ngSwitchCase]="'edit'">
									<button *ngIf="keycloakService.isUserAdmin() || keycloakService.isUserExpert()" i18n="Edit model|Add a new ingredient" (click)="goToAddIngredient()">
										<i class="fas fa-plus-square"></i>
										new ingredient
									</button>
								</ng-template>
								<ng-template [ngSwitchCase]="'create'" *ngIf="keycloakService.isUserAdmin() || keycloakService.isUserExpert()">
									<button *ngIf="keycloakService.isUserAdmin() || keycloakService.isUserExpert()" i18n="Edit model|Add a new ingredient" (click)="goToAddIngredient()">
										<i class="fas fa-plus-square"></i>
										new ingredient
									</button>
								</ng-template>
							</div>
							<div>
								<anesthetic-ingredient-form [anesthetic]="anesthetic" [createAIMode]="createAIMode"  
											[toggleForm]="toggleFormAI" [ingredientSelected]="ingredientSelected" (onEvent)="refreshDisplay($event)"></anesthetic-ingredient-form>
							</div>
							<shanoir-table #ingredientsTable
								[getPage]="getPage.bind(this)" 
								[columnDefs]="columnDefs">
							</shanoir-table>
							
						</li>
					</ol>
					</fieldset>
				</td>
			</tr>
		</table>
    </form>
    
    <form-footer
			[state]="footerState"
			(save)="save()"
			(edit)="goToEdit()"
			(back)="goBack()">
	</form-footer>
    
</div>