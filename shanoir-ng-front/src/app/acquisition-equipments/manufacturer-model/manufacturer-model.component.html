<!--
Shanoir NG - Import, manage and share neuroimaging data
Copyright (C) 2009-2019 Inria - https://www.inria.fr/
Contact us on https://project.inria.fr/shanoir/

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

You should have received a copy of the GNU General Public License
along with this program. If not, see https://www.gnu.org/licenses/gpl-3.0.html
-->
<div #formContainer class="content-component">
    @if (form) {
        <form [formGroup]="form" class="max-content" novalidate [class.disabled]="footerState.loading">
            <div class="layout">
                <form-footer
                    [state]="footerState"
                    (save)="save()"
                    (delete)="delete()"
                    (edit)="goToEdit()"
                    (dismiss)="goToView()"
                    (back)="goBack()"></form-footer>
                <span>
                    @switch (mode) {
                        @case ("view") {
                            <h2 class="header command-zone" i18n="View manufModel|Title@@manufModelDetailViewTitle">
                                Details on manufacturer model
                            </h2>
                        }
                        @case ("edit") {
                            <h2 class="header command-zone" i18n="Edit manufModel|Title@@manufModelDetailEditTitle">
                                Edit manufacturer model
                            </h2>
                        }
                        @case ("create") {
                            <h2 class="header command-zone" i18n="Create manufModel|Title@@manufModelDetailCreateTitle">
                                Create manufacturer model
                            </h2>
                        }
                    }
                </span>
                <help-message [help]="'equipment'"></help-message>
                <fieldset>
                    <ol>
                        <li>
                            <label i18n="ManufModel detail|Modality type label@@manufModelDetailModalityType">
                                Modality type
                            </label>
                            <span class="right-col">
                                @switch (mode) {
                                    @case ("view") {
                                        {{ manufModel.datasetModalityType }}
                                    }
                                    @default {
                                        <select-box
                                            formControlName="datasetModalityType"
                                            [options]="datasetModalityTypes"
                                            (userChange)="onModalityChange($event)"></select-box>
                                    }
                                }
                            </span>
                        </li>
                        <li>
                            <label i18n="ManufModel detail|Manufacturer label@@manufModelDetailManuf">
                                Manufacturer
                            </label>
                            <span class="right-col">
                                @switch (mode) {
                                    @case ("view") {
                                        <a [routerLink]="['/manufacturer/details/', manufModel?.manufacturer?.id]">
                                            {{ manufModel.manufacturer?.name }}
                                        </a>
                                    }
                                    @default {
                                        <select-box
                                            formControlName="manufacturer"
                                            (newClick)="openNewManuf()"
                                            [optionArr]="manufs"></select-box>
                                    }
                                }
                            </span>
                        </li>
                        <li>
                            <label i18n="ManufModel detail|Model name label@@manufModelDetailName">Model name</label>
                            <span class="right-col">
                                @switch (mode) {
                                    @case ("view") {
                                        {{ manufModel.name }}
                                    }
                                    @default {
                                        <input type="text" id="name" formControlName="name" />
                                        @if (hasError("name", ["required"])) {
                                            <label
                                                class="form-validation-alert"
                                                i18n="
                                                    ManufModel detail|Name required
                                                    error@@manufModelDetailNameRequiredError">
                                                Name is required!
                                            </label>
                                        }
                                        @if (hasError("name", ["minlength", "maxlength"])) {
                                            <label
                                                class="form-validation-alert"
                                                i18n="
                                                    ManufModel detail|Name length error@@manufModelDetailNameLengthError">
                                                Name length must be between 2 and 200!
                                            </label>
                                        }
                                        @if (hasError("name", ["unique"])) {
                                            <label
                                                class="form-validation-alert"
                                                i18n="
                                                    ManufModel detail|Name unique error@@manufModelDetailNameUniqueError">
                                                Name should be unique!
                                            </label>
                                        }
                                    }
                                }
                            </span>
                        </li>
                        @if (isMR) {
                            <li>
                                <label i18n="ManufModel detail|Magnetic field label@@manufModelDetailMagneticField">
                                    Magnetic field ({{ getUnit("TESLA") }})
                                </label>
                                <span class="right-col">
                                    @switch (mode) {
                                        @case ("view") {
                                            {{ manufModel.magneticField }}
                                        }
                                        @default {
                                            <input
                                                type="text"
                                                pattern="[0-9]+([.][0-9]+)?"
                                                id="magneticField"
                                                formControlName="magneticField" />
                                            @if (hasError("magneticField", ["required"])) {
                                                <label
                                                    class="form-validation-alert"
                                                    i18n="
                                                        ManufModel detail|Magnetic field required
                                                        error@@manufModelDetailMagneticFieldRequiredError">
                                                    Magnetic field is required!
                                                </label>
                                            }
                                            @if (hasError("magneticField", ["pattern"])) {
                                                <label
                                                    class="form-validation-alert"
                                                    i18n="
                                                        ManufModel detail|Magnetic field pattern
                                                        error@@manufModelDetailMagneticFieldPatternError">
                                                    Magnetic field should be a number!
                                                </label>
                                            }
                                        }
                                    }
                                </span>
                            </li>
                        }
                    </ol>
                </fieldset>
            </div>
        </form>
    }
</div>
